services:
 nginx:
   image: nginx:alpine
   container_name: retro-hunter-nginx
   ports:
     - "443:443"
   volumes:
     - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
     - ./nginx/certs:/etc/nginx/certs:ro
   depends_on:
     - frontend
     - api
   networks:
     - retro-net
   restart: unless-stopped

 frontend:
   build: ./frontend
   container_name: retro-hunter-frontend
   expose:
     - "3000"
   networks:
     - retro-net
   restart: unless-stopped

 api:
   build: ./backend
   container_name: retro-hunter-api
   env_file:
     - .env
   expose:
     - "8000"
   depends_on:
     - db
   networks:
     - retro-net
   restart: unless-stopped

 db:
   image: postgres:15
   container_name: retro-hunter-db
   env_file:
     - .env
   volumes:
     - pgdata:/var/lib/postgresql/data
   networks:
     - retro-net
   restart: unless-stopped

networks:
 retro-net:

volumes:
 pgdata:
